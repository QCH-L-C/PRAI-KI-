name: Validate Self-Hosted Runner

on:
  workflow_dispatch:

jobs:
  validate-runner:
    runs-on: self-hosted

    steps:
      # Schritt 1: Überprüfen der Python-Installation
      - name: Validate Python Environment
        run: |
          echo "Überprüfen der Python-Installation..."
          python3 --version || echo "Python ist nicht installiert!"
          pip3 --version || echo "Pip ist nicht installiert!"

      # Schritt 2: Runner-Dienste überprüfen
      - name: Validate Runner Services
        run: |
          echo "Überprüfen, ob der Runner-Dienst aktiv ist..."
          ps aux | grep actions-runner || echo "Self-Hosted Runner ist nicht aktiv!"

      # Schritt 3: Debug-Tools installieren
      - name: Install Debug Tools
        run: |
          sudo apt-get update && sudo apt-get install -y net-tools
          echo "Debug-Tools installiert."


name: Validate Runner Setup

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  validate-runner:
    runs-on: ubuntu-latest

    steps:
      - name: Check out Repository
        uses: actions/checkout@v3

      - name: Validate Runner Logs
        run: |
          python home/<username>/actions-runner/debug_runner_logs.py


name: Auto Update Dependencies

on:
  workflow_dispatch: # Manuelles Starten des Workflows möglich

jobs:
  update-dependencies:
    runs-on: ubuntu-latest

    steps:
      - name: Check out Repository
        uses: actions/checkout@v3

      - name: Set up Python Environment
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      - name: Start Continuous Updates
        run: |
          echo "Starte kontinuierliche Updates der Abhängigkeiten..."
          while true; do
            echo "Update-Prozess gestartet..."
            
            # Upgrade pip
            python -m pip install --upgrade pip
            
            # Installiere Abhängigkeiten
            pip install -U -r requirements.txt
            echo "Abhängigkeiten erfolgreich aktualisiert!"
            
            # Liste installierte Pakete auf
            pip list
            
            echo "Warte 30 Sekunden auf den nächsten Lauf..."
            sleep 30
          done
